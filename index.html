<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Resource Library</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/w3-css/4.15/w3.css">
  <script>
    // ğŸ”§ Replace these values with your actual GitHub info
    const username = "Akono-Flow";
    const repo = "teaching-resources";
    const branch = "main"; // or "master" if applicable

    let currentPath = "";
    let currentItems = [];

    // ğŸ§­ Render breadcrumb navigation
    function renderBreadcrumb() {
      const breadcrumb = document.getElementById("breadcrumb");
      const parts = currentPath.split("/").filter(Boolean);
      breadcrumb.innerHTML = '<a href="#" onclick="navigateTo(\'\')">ğŸ  Home</a>';

      let cumulativePath = "";
      for (const part of parts) {
        cumulativePath += (cumulativePath ? "/" : "") + part;
        breadcrumb.innerHTML +=
          ` / <a href="#" onclick="navigateTo('${cumulativePath}')">${part}</a>`;
      }
    }

    // ğŸ—‚ï¸ Fetch folder contents from GitHub API
    async function fetchFolderContents(path = "") {
      const apiUrl = `https://api.github.com/repos/${username}/${repo}/contents/${path}?ref=${branch}`;
      const response = await fetch(apiUrl);
      if (!response.ok) throw new Error("Failed to load contents");
      currentItems = await response.json();
      currentPath = path;
      renderBreadcrumb();
      renderFileList();
    }

    // ğŸ“‹ Render files and folders in the list
    function renderFileList(filterText = "") {
      const container = document.getElementById("file-list");
      container.innerHTML = "";

      const filtered = currentItems.filter(item =>
        item.name.toLowerCase().includes(filterText.toLowerCase())
      );

      if (filtered.length === 0) {
        container.innerHTML = "<p class='w3-text-grey'>No matching files or folders.</p>";
        return;
      }

      const ul = document.createElement("ul");
      ul.className = "w3-ul w3-card w3-white";

      for (const item of filtered) {
        const li = document.createElement("li");
        li.className = "w3-padding-16";

        if (item.type === "dir") {
          li.innerHTML = `ğŸ“‚ <a href="#" onclick="navigateTo('${item.path}')">${item.name}</a>`;
        } else {
          const fileUrl = `https://raw.githubusercontent.com/${username}/${repo}/${branch}/${item.path}`;
          li.innerHTML = `ğŸ“„ <a href="${fileUrl}" target="_blank">${item.name}</a>`;
        }

        ul.appendChild(li);
      }

      container.appendChild(ul);
    }

    // ğŸ” Search files and folders
    function handleSearch(event) {
      const searchText = event.target.value;
      renderFileList(searchText);
    }

    // ğŸ§­ Navigate into or back out of folders
    function navigateTo(path) {
      fetchFolderContents(path);
    }

    window.onload = () => fetchFolderContents();
  </script>
</head>
<body class="w3-light-grey">

  <!-- Header -->
  <header class="w3-container w3-blue w3-center w3-padding-32">
    <h1 class="w3-xxlarge">Resource Library - M Cole</h1>
    <p>Automatically updated from my GitHub repository</p>
  </header>

  <div class="w3-content w3-padding">

    <!-- Breadcrumb -->
    <div class="w3-margin-bottom w3-padding-small w3-small">
      <span id="breadcrumb" class="w3-text-blue"></span>
    </div>

    <!-- Search bar -->
    <div class="w3-margin-bottom">
      <input
        type="text"
        class="w3-input w3-border w3-round"
        placeholder="Search files or folders..."
        oninput="handleSearch(event)"
      >
    </div>

    <!-- File list -->
    <div id="file-list"></div>

  </div>

  <!-- Footer -->
  <footer class="w3-container w3-center w3-blue w3-padding">
    <p>Hosted with â¤ï¸ using GitHub Pages + GitHub API</p>
  </footer>

</body>
</html>

